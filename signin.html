<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Blueground on Mars</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Rubik:300" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Space+Mono:400i" rel="stylesheet">
	<!-- Add icon library -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32" />
	<link rel="stylesheet" type="text/css" href="css/normalize.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
       window.addEventListener('load', function() {
        var btnForm = document.getElementsByClassName("signin-btn")[0];
        btnForm.addEventListener('click', function() {
        var email = document.getElementById("formEmail").value;
        var password = document.getElementById("formPassword").value;
        params = {
            email,
            password
        }
            
        var url = "https://mars.theblueground.net/api/auth/login";

        var xhr = new XMLHttpRequest();
        xhr.open("POST", url);

        xhr.setRequestHeader("Content-Type", "application/json");

        xhr.onreadystatechange = function () {
           if (xhr.readyState === 4) {
              console.log(xhr.status);
              console.log(JSON.parse(xhr.responseText));
              console.log(xhr);
              console.info(xhr.user);
              var responseText = xhr.responseText;
              if (xhr.status === 200 && responseText) {
                username = JSON.parse(responseText)?.user?.name;
                document.cookie = JSON.stringify({username});
                window.location.href = 'index.html';
           }
           }};

        var data = JSON.stringify(params);
        console.info(data);
        xhr.send(data);       

    });
});

    </script>
</head>

<body class="signin-page">
	<div class=container>
		<div class="signin-wrapper-1">
			<div class="signin-wrapper-2">
				<h2>Blueground on <span class="circle">Mars</span></h2>
				<form method="post" action="javascript:void(0)">
					<input type="email" placeholder="Colonist Id" name="uname" id="formEmail" required>
					<input type="password" placeholder="Password" name="psw" id="formPassword" maxlength="128" required>
					<button type="submit" class="btn signin-btn">Sign in</button>
				</form>
			</div>
		</div>
	</div>
</body>

</html>